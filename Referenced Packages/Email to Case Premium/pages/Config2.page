<apex:page controller="E2CP.Config2" action="{!loadPreferences}" tabStyle="settings__tab">
    <style>
        !div.pbSubheader{color:#000000 !important;}
    </style>
    <apex:sectionHeader title="Email to Case Premium" subtitle="Preferences Configuration" help="http://www.ic-2000.com/support.asp" />
    
    <apex:form >
        <apex:pageMessages showDetail="false" id="pgmsgs" />
        <apex:pageBlock title="Step 1: Outbound Configuration"> 

            <apex:facet name="header">
                <apex:outputpanel >
                <table width="100%">
                <tr>
                
                <td style="width:75%; text-align:center;">
                    <apex:commandButton action="{!previous}" value="Previous"/>
                    <apex:actionStatus id="quickStatus">
                        <apex:facet name="start">
                            <apex:outputPanel >
                                <div style="z-index:99; position:absolute; top:0px; left:0px; width:100%; height:100%; background-color:silver; opacity:.30; filter: alpha(opacity = 30);"></div> 
                                <apex:commandButton value="Saving..." disabled="true"/>
                            </apex:outputPanel> 
                        </apex:facet>
                        <apex:facet name="stop">
                            <apex:commandButton action="{!quick}" value="Quick Save" rerender="quickStatus,pgmsgs" status="quickStatus"/>
                        </apex:facet>
                    </apex:actionStatus>   
                    <apex:commandButton action="{!next}" value="Next"/>
                </td>
                
                <td style="text-align:right;">
                    <!--pageJumper start-->
                    <apex:outputPanel >
                         <apex:actionStatus id="pjStatus">
                            <apex:facet name="start">
                                <apex:outputtext value="{!pj.statusText}"/> 
                            </apex:facet>
                            <apex:facet name="stop">
                                <apex:outputpanel >
                                    <apex:outputLabel for="pagejump" value="Jump to "/>
                                    <apex:selectList value="{!pj.currentPage}"  id="pagejump" size="1">
                                        <apex:selectOptions value="{!pj.allPages}"/>
                                        <apex:actionSupport event="onchange" action="{!jumpToPage}" status="pjStatus"/>
                                    </apex:selectList> 
                                </apex:outputpanel>
                            </apex:facet>
                        </apex:actionStatus>
                    </apex:outputpanel>
                    <!--pageJumper end-->
                </td>
                
                </tr>
                </table>
                </apex:outputPanel>
            </apex:facet>
            
            <apex:facet name="footer">
                <apex:outputpanel >
                <table width="100%">
                <tr>
                <td style="width:75%; text-align:center;">
                    <apex:commandButton action="{!previous}" value="Previous"/>
                    <apex:actionStatus id="quickStatus2">
                        <apex:facet name="start">
                            <apex:outputPanel >
                                <div style="z-index:99; position:absolute; top:0px; left:0px; width:100%; height:100%; background-color:silver; opacity:.30; filter: alpha(opacity = 30);"></div> 
                                <apex:commandButton value="Saving..." disabled="true"/>
                            </apex:outputPanel>  
                        </apex:facet>
                        <apex:facet name="stop">
                            <apex:commandButton action="{!quick}" value="Quick Save" rerender="quickStatus2,pgmsgs" status="quickStatus2"/>
                        </apex:facet>
                    </apex:actionStatus>   
                    <apex:commandButton action="{!next}" value="Next"/>
                </td>
                <td>
                </td>
                </tr>
                </table>
                </apex:outputPanel>
            </apex:facet>
            

            <apex:pageBlockSection collapsible="false" title="Page Description" columns="1" id="prefDescPBS" showHeader="false">These settings affect the features available on the New Comment page and the outbound email it generates.</apex:pageBlockSection>


            <!-- ///////////General Settings//////////// -->

            <apex:pageBlockSection title="General Settings" columns="1" id="basicPrefPBS">
            
                <apex:pageBlockSectionItem id="REPLY_TO_ADDRESS_PBSI"
                helpText="To ensure that replies are processed by Email to Case Premium, select an address that emails should be sent From when adding a new comment.">
                    <apex:outputLabel value="Default Org Wide Address" for="REPLY_TO_ADDRESS_Text"/>
                    <apex:selectList multiselect="false" id="REPLY_TO_ADDRESS_Text" value="{!REPLY_TO_ADDRESS}" required="true" size="1">
                        <apex:selectOptions value="{!REPLY_TO_ADDRESS_OPTIONS}"/>
                    </apex:selectList>
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="REPLY_TO_ADDRESS_BY_ORIGIN_PBSI"
                helpText="Email to Case Premium can automatically select a different From address to use for outbound case comment emails based on any case picklist field.  You must add all Org Wide Addresses by navigating to Setup > Administration Setup > Email Administration > Organization-Wide Addresses.">
                    <apex:outputLabel value="Org Wide Address by Case Field" for="REPLY_TO_ADDRESS_BY_ORIGIN_Panel"/>
                    <apex:outputPanel id="REPLY_TO_ADDRESS_BY_ORIGIN_Panel" >
                        <apex:outputPanel id="ORGWIDE_CONTROLLING_FIELD_Panel">
                            <b>Controlling Field</b>&nbsp;
                            <apex:selectList value="{!ORGWIDE_CONTROLLING_FIELD}" multiselect="false" size="1">
                                <apex:selectOptions value="{!OrgWideFieldOpts}" />
                                <apex:actionSupport event="onchange" rerender="REPLY_TO_ADDRESS_BY_ORIGIN_Panel"/>
                            </apex:selectList>
                        </apex:outputPanel>
                        
                        <br/>&nbsp;
                        
                        <apex:outputPanel id="REPLY_TO_ADDRESS_BY_ORIGIN_EditPanel">
                                <table>
                                    <tr>
                                        <td><apex:outputText value="Value" style="font-weight:bold;" /></td>
                                        <td><apex:outputText value="From Address" style="font-weight:bold;" /></td>
                                    </tr>
                                    <apex:repeat value="{!lstInnerRTABO}" var="e1" id="rptRTABO">
                                        <tr>
                                            <td><apex:selectList id="REPLY_TO_ORIGIN_Text" required="false" value="{!e1.prefKey}" multiselect="false" size="1">
                                                    <apex:selectOptions value="{!OrgWidePicklistOpts}"/>
                                                </apex:selectList>
                                            </td>
                                            <td><apex:selectList id="REPLY_TO_ADDRESS_Text" required="false" value="{!e1.prefValue}" multiselect="false" size="1">
                                                    <apex:selectOptions value="{!REPLY_TO_ADDRESS_NONREQ_OPTIONS}" />
                                                </apex:selectList>
                                            </td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                                <apex:commandbutton value="Add Row" action="{!Add}" rerender="REPLY_TO_ADDRESS_BY_ORIGIN_EditPanel">
                                    <apex:param name="param1" value="1" />
                                </apex:commandbutton>
                        </apex:outputPanel>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="DISPLAY_TIME_ZONE_PBSI"
                helpText="Comments are stored in Salesforce.com using UTC time and displayed in the timezone you configure for the application.  This configuration enables you to control the time zone used in emails that are sent when you add a comment.">
                    <apex:outputLabel value="Timezone"
                    for="DISPLAY_TIME_ZONE_Select"/>
                    <apex:selectList value="{!DISPLAY_TIME_ZONE}" multiselect="false" size="1" title="The timezone used when listing comments chronologically in the email" id="DISPLAY_TIME_ZONE_Select" required="true" >
                        <apex:selectOption itemValue="Africa/Abidjan" />
                        <apex:selectOption itemValue="Africa/Accra" />
                        <apex:selectOption itemValue="Africa/Addis_Ababa" />
                        <apex:selectOption itemValue="Africa/Algiers" />
                        <apex:selectOption itemValue="Africa/Asmera" />
                        <apex:selectOption itemValue="Africa/Bangui" />
                        <apex:selectOption itemValue="Africa/Bissau" />
                        <apex:selectOption itemValue="Africa/Blantyre" />
                        <apex:selectOption itemValue="Africa/Bujumbura" />
                        <apex:selectOption itemValue="Africa/Cairo" />
                        <apex:selectOption itemValue="Africa/Casablanca" />
                        <apex:selectOption itemValue="Africa/Conakry" />
                        <apex:selectOption itemValue="Africa/Dakar" />
                        <apex:selectOption itemValue="Africa/Dar_es_Salaam" />
                        <apex:selectOption itemValue="Africa/Djibouti" />
                        <apex:selectOption itemValue="Africa/Douala" />
                        <apex:selectOption itemValue="Africa/Freetown" />
                        <apex:selectOption itemValue="Africa/Gaborone" />
                        <apex:selectOption itemValue="Africa/Harare" />
                        <apex:selectOption itemValue="Africa/Johannesburg" />
                        <apex:selectOption itemValue="Africa/Kampala" />
                        <apex:selectOption itemValue="Africa/Khartoum" />
                        <apex:selectOption itemValue="Africa/Kigali" />
                        <apex:selectOption itemValue="Africa/Kinshasa" />
                        <apex:selectOption itemValue="Africa/Lagos" />
                        <apex:selectOption itemValue="Africa/Libreville" />
                        <apex:selectOption itemValue="Africa/Lome" />
                        <apex:selectOption itemValue="Africa/Luanda" />
                        <apex:selectOption itemValue="Africa/Lubumbashi" />
                        <apex:selectOption itemValue="Africa/Lusaka" />
                        <apex:selectOption itemValue="Africa/Malabo" />
                        <apex:selectOption itemValue="Africa/Maputo" />
                        <apex:selectOption itemValue="Africa/Maseru" />
                        <apex:selectOption itemValue="Africa/Mbabane" />
                        <apex:selectOption itemValue="Africa/Mogadishu" />
                        <apex:selectOption itemValue="Africa/Monrovia" />
                        <apex:selectOption itemValue="Africa/Nairobi" />
                        <apex:selectOption itemValue="Africa/Ndjamena" />
                        <apex:selectOption itemValue="Africa/Niamey" />
                        <apex:selectOption itemValue="Africa/Nouakchott" />
                        <apex:selectOption itemValue="Africa/Ouagadougou" />
                        <apex:selectOption itemValue="Africa/Porto-Novo" />
                        <apex:selectOption itemValue="Africa/Sao_Tome" />
                        <apex:selectOption itemValue="Africa/Timbuktu" />
                        <apex:selectOption itemValue="Africa/Tripoli" />
                        <apex:selectOption itemValue="Africa/Tunis" />
                        <apex:selectOption itemValue="Africa/Windhoek" />
                        <apex:selectOption itemValue="America/Adak" />
                        <apex:selectOption itemValue="America/Anchorage" />
                        <apex:selectOption itemValue="America/Anguilla" />
                        <apex:selectOption itemValue="America/Antigua" />
                        <apex:selectOption itemValue="America/Aruba" />
                        <apex:selectOption itemValue="America/Asuncion" />
                        <apex:selectOption itemValue="America/Barbados" />
                        <apex:selectOption itemValue="America/Belize" />
                        <apex:selectOption itemValue="America/Bogota" />
                        <apex:selectOption itemValue="America/Buenos_Aires" />
                        <apex:selectOption itemValue="America/Caracas" />
                        <apex:selectOption itemValue="America/Cayenne" />
                        <apex:selectOption itemValue="America/Cayman" />
                        <apex:selectOption itemValue="America/Chicago" />
                        <apex:selectOption itemValue="America/Costa_Rica" />
                        <apex:selectOption itemValue="America/Cuiaba" />
                        <apex:selectOption itemValue="America/Curacao" />
                        <apex:selectOption itemValue="America/Dawson_Creek" />
                        <apex:selectOption itemValue="America/Denver" />
                        <apex:selectOption itemValue="America/Dominica" />
                        <apex:selectOption itemValue="America/Edmonton" />
                        <apex:selectOption itemValue="America/El_Salvador" />
                        <apex:selectOption itemValue="America/Fortaleza" />
                        <apex:selectOption itemValue="America/Godthab" />
                        <apex:selectOption itemValue="America/Grand_Turk" />
                        <apex:selectOption itemValue="America/Grenada" />
                        <apex:selectOption itemValue="America/Guadeloupe" />
                        <apex:selectOption itemValue="America/Guatemala" />
                        <apex:selectOption itemValue="America/Guayaquil" />
                        <apex:selectOption itemValue="America/Guyana" />
                        <apex:selectOption itemValue="America/Halifax" />
                        <apex:selectOption itemValue="America/Havana" />
                        <apex:selectOption itemValue="America/Indianapolis" />
                        <apex:selectOption itemValue="America/Jamaica" />
                        <apex:selectOption itemValue="America/La_Paz" />
                        <apex:selectOption itemValue="America/Lima" />
                        <apex:selectOption itemValue="America/Los_Angeles" />
                        <apex:selectOption itemValue="America/Managua" />
                        <apex:selectOption itemValue="America/Manaus" />
                        <apex:selectOption itemValue="America/Martinique" />
                        <apex:selectOption itemValue="America/Mazatlan" />
                        <apex:selectOption itemValue="America/Mexico_City" />
                        <apex:selectOption itemValue="America/Miquelon" />
                        <apex:selectOption itemValue="America/Montevideo" />
                        <apex:selectOption itemValue="America/Montreal" />
                        <apex:selectOption itemValue="America/Montserrat" />
                        <apex:selectOption itemValue="America/Nassau" />
                        <apex:selectOption itemValue="America/New_York" />
                        <apex:selectOption itemValue="America/Noronha" />
                        <apex:selectOption itemValue="America/Panama" />
                        <apex:selectOption itemValue="America/Paramaribo" />
                        <apex:selectOption itemValue="America/Phoenix" />
                        <apex:selectOption itemValue="America/Port-au-Prince" />
                        <apex:selectOption itemValue="America/Port_of_Spain" />
                        <apex:selectOption itemValue="America/Porto_Acre" />
                        <apex:selectOption itemValue="America/Puerto_Rico" />
                        <apex:selectOption itemValue="America/Regina" />
                        <apex:selectOption itemValue="America/Santiago" />
                        <apex:selectOption itemValue="America/Santo_Domingo" />
                        <apex:selectOption itemValue="America/Sao_Paulo" />
                        <apex:selectOption itemValue="America/Scoresbysund" />
                        <apex:selectOption itemValue="America/St_Johns" />
                        <apex:selectOption itemValue="America/St_Kitts" />
                        <apex:selectOption itemValue="America/St_Lucia" />
                        <apex:selectOption itemValue="America/St_Thomas" />
                        <apex:selectOption itemValue="America/St_Vincent" />
                        <apex:selectOption itemValue="America/Tegucigalpa" />
                        <apex:selectOption itemValue="America/Thule" />
                        <apex:selectOption itemValue="America/Tijuana" />
                        <apex:selectOption itemValue="America/Tortola" />
                        <apex:selectOption itemValue="America/Vancouver" />
                        <apex:selectOption itemValue="America/Winnipeg" />
                        <apex:selectOption itemValue="Antarctica/Casey" />
                        <apex:selectOption itemValue="Antarctica/DumontDUrville" />
                        <apex:selectOption itemValue="Antarctica/Mawson" />
                        <apex:selectOption itemValue="Antarctica/McMurdo" />
                        <apex:selectOption itemValue="Antarctica/Palmer" />
                        <apex:selectOption itemValue="Asia/Aden" />
                        <apex:selectOption itemValue="Asia/Almaty" />
                        <apex:selectOption itemValue="Asia/Amman" />
                        <apex:selectOption itemValue="Asia/Anadyr" />
                        <apex:selectOption itemValue="Asia/Aqtau" />
                        <apex:selectOption itemValue="Asia/Aqtobe" />
                        <apex:selectOption itemValue="Asia/Ashkhabad" />
                        <apex:selectOption itemValue="Asia/Baghdad" />
                        <apex:selectOption itemValue="Asia/Bahrain" />
                        <apex:selectOption itemValue="Asia/Baku" />
                        <apex:selectOption itemValue="Asia/Bangkok" />
                        <apex:selectOption itemValue="Asia/Beirut" />
                        <apex:selectOption itemValue="Asia/Bishkek" />
                        <apex:selectOption itemValue="Asia/Brunei" />
                        <apex:selectOption itemValue="Asia/Calcutta" />
                        <apex:selectOption itemValue="Asia/Colombo" />
                        <apex:selectOption itemValue="Asia/Dacca" />
                        <apex:selectOption itemValue="Asia/Damascus" />
                        <apex:selectOption itemValue="Asia/Dubai" />
                        <apex:selectOption itemValue="Asia/Dushanbe" />
                        <apex:selectOption itemValue="Asia/Hong_Kong" />
                        <apex:selectOption itemValue="Asia/Irkutsk" />
                        <apex:selectOption itemValue="Asia/Jakarta" />
                        <apex:selectOption itemValue="Asia/Jayapura" />
                        <apex:selectOption itemValue="Asia/Jerusalem" />
                        <apex:selectOption itemValue="Asia/Kabul" />
                        <apex:selectOption itemValue="Asia/Kamchatka" />
                        <apex:selectOption itemValue="Asia/Karachi" />
                        <apex:selectOption itemValue="Asia/Katmandu" />
                        <apex:selectOption itemValue="Asia/Krasnoyarsk" />
                        <apex:selectOption itemValue="Asia/Kuala_Lumpur" />
                        <apex:selectOption itemValue="Asia/Kuwait" />
                        <apex:selectOption itemValue="Asia/Macao" />
                        <apex:selectOption itemValue="Asia/Magadan" />
                        <apex:selectOption itemValue="Asia/Manila" />
                        <apex:selectOption itemValue="Asia/Muscat" />
                        <apex:selectOption itemValue="Asia/Nicosia" />
                        <apex:selectOption itemValue="Asia/Novosibirsk" />
                        <apex:selectOption itemValue="Asia/Phnom_Penh" />
                        <apex:selectOption itemValue="Asia/Pyongyang" />
                        <apex:selectOption itemValue="Asia/Qatar" />
                        <apex:selectOption itemValue="Asia/Rangoon" />
                        <apex:selectOption itemValue="Asia/Riyadh" />
                        <apex:selectOption itemValue="Asia/Saigon" />
                        <apex:selectOption itemValue="Asia/Seoul" />
                        <apex:selectOption itemValue="Asia/Shanghai" />
                        <apex:selectOption itemValue="Asia/Singapore" />
                        <apex:selectOption itemValue="Asia/Taipei" />
                        <apex:selectOption itemValue="Asia/Tashkent" />
                        <apex:selectOption itemValue="Asia/Tbilisi" />
                        <apex:selectOption itemValue="Asia/Tehran" />
                        <apex:selectOption itemValue="Asia/Thimbu" />
                        <apex:selectOption itemValue="Asia/Tokyo" />
                        <apex:selectOption itemValue="Asia/Ujung_Pandang" />
                        <apex:selectOption itemValue="Asia/Ulan_Bator" />
                        <apex:selectOption itemValue="Asia/Vientiane" />
                        <apex:selectOption itemValue="Asia/Vladivostok" />
                        <apex:selectOption itemValue="Asia/Yakutsk" />
                        <apex:selectOption itemValue="Asia/Yekaterinburg" />
                        <apex:selectOption itemValue="Asia/Yerevan" />
                        <apex:selectOption itemValue="Atlantic/Azores" />
                        <apex:selectOption itemValue="Atlantic/Bermuda" />
                        <apex:selectOption itemValue="Atlantic/Canary" />
                        <apex:selectOption itemValue="Atlantic/Cape_Verde" />
                        <apex:selectOption itemValue="Atlantic/Faeroe" />
                        <apex:selectOption itemValue="Atlantic/Jan_Mayen" />
                        <apex:selectOption itemValue="Atlantic/Reykjavik" />
                        <apex:selectOption itemValue="Atlantic/South_Georgia" />
                        <apex:selectOption itemValue="Atlantic/St_Helena" />
                        <apex:selectOption itemValue="Atlantic/Stanley" />
                        <apex:selectOption itemValue="Australia/Adelaide" />
                        <apex:selectOption itemValue="Australia/Brisbane" />
                        <apex:selectOption itemValue="Australia/Broken_Hill" />
                        <apex:selectOption itemValue="Australia/Darwin" />
                        <apex:selectOption itemValue="Australia/Hobart" />
                        <apex:selectOption itemValue="Australia/Lord_Howe" />
                        <apex:selectOption itemValue="Australia/Perth" />
                        <apex:selectOption itemValue="Australia/Sydney" />
                        <apex:selectOption itemValue="Europe/Amsterdam" />
                        <apex:selectOption itemValue="Europe/Andorra" />
                        <apex:selectOption itemValue="Europe/Athens" />
                        <apex:selectOption itemValue="Europe/Belgrade" />
                        <apex:selectOption itemValue="Europe/Berlin" />
                        <apex:selectOption itemValue="Europe/Brussels" />
                        <apex:selectOption itemValue="Europe/Bucharest" />
                        <apex:selectOption itemValue="Europe/Budapest" />
                        <apex:selectOption itemValue="Europe/Chisinau" />
                        <apex:selectOption itemValue="Europe/Copenhagen" />
                        <apex:selectOption itemValue="Europe/Dublin" />
                        <apex:selectOption itemValue="Europe/Gibraltar" />
                        <apex:selectOption itemValue="Europe/Helsinki" />
                        <apex:selectOption itemValue="Europe/Istanbul" />
                        <apex:selectOption itemValue="Europe/Kaliningrad" />
                        <apex:selectOption itemValue="Europe/Kiev" />
                        <apex:selectOption itemValue="Europe/Lisbon" />
                        <apex:selectOption itemValue="Europe/London" />
                        <apex:selectOption itemValue="Europe/Luxembourg" />
                        <apex:selectOption itemValue="Europe/Madrid" />
                        <apex:selectOption itemValue="Europe/Malta" />
                        <apex:selectOption itemValue="Europe/Minsk" />
                        <apex:selectOption itemValue="Europe/Monaco" />
                        <apex:selectOption itemValue="Europe/Moscow" />
                        <apex:selectOption itemValue="Europe/Oslo" />
                        <apex:selectOption itemValue="Europe/Paris" />
                        <apex:selectOption itemValue="Europe/Prague" />
                        <apex:selectOption itemValue="Europe/Riga" />
                        <apex:selectOption itemValue="Europe/Rome" />
                        <apex:selectOption itemValue="Europe/Samara" />
                        <apex:selectOption itemValue="Europe/Simferopol" />
                        <apex:selectOption itemValue="Europe/Sofia" />
                        <apex:selectOption itemValue="Europe/Stockholm" />
                        <apex:selectOption itemValue="Europe/Tallinn" />
                        <apex:selectOption itemValue="Europe/Tirane" />
                        <apex:selectOption itemValue="Europe/Vaduz" />
                        <apex:selectOption itemValue="Europe/Vienna" />
                        <apex:selectOption itemValue="Europe/Vilnius" />
                        <apex:selectOption itemValue="Europe/Warsaw" />
                        <apex:selectOption itemValue="Europe/Zurich" />
                        <apex:selectOption itemValue="Indian/Antananarivo" />
                        <apex:selectOption itemValue="Indian/Chagos" />
                        <apex:selectOption itemValue="Indian/Christmas" />
                        <apex:selectOption itemValue="Indian/Cocos" />
                        <apex:selectOption itemValue="Indian/Comoro" />
                        <apex:selectOption itemValue="Indian/Kerguelen" />
                        <apex:selectOption itemValue="Indian/Mahe" />
                        <apex:selectOption itemValue="Indian/Maldives" />
                        <apex:selectOption itemValue="Indian/Mauritius" />
                        <apex:selectOption itemValue="Indian/Mayotte" />
                        <apex:selectOption itemValue="Indian/Reunion" />
                        <apex:selectOption itemValue="Pacific/Apia" />
                        <apex:selectOption itemValue="Pacific/Auckland" />
                        <apex:selectOption itemValue="Pacific/Chatham" />
                        <apex:selectOption itemValue="Pacific/Easter" />
                        <apex:selectOption itemValue="Pacific/Efate" />
                        <apex:selectOption itemValue="Pacific/Enderbury" />
                        <apex:selectOption itemValue="Pacific/Fakaofo" />
                        <apex:selectOption itemValue="Pacific/Fiji" />
                        <apex:selectOption itemValue="Pacific/Funafuti" />
                        <apex:selectOption itemValue="Pacific/Galapagos" />
                        <apex:selectOption itemValue="Pacific/Gambier" />
                        <apex:selectOption itemValue="Pacific/Guadalcanal" />
                        <apex:selectOption itemValue="Pacific/Guam" />
                        <apex:selectOption itemValue="Pacific/Honolulu" />
                        <apex:selectOption itemValue="Pacific/Kiritimati" />
                        <apex:selectOption itemValue="Pacific/Kosrae" />
                        <apex:selectOption itemValue="Pacific/Majuro" />
                        <apex:selectOption itemValue="Pacific/Marquesas" />
                        <apex:selectOption itemValue="Pacific/Nauru" />
                        <apex:selectOption itemValue="Pacific/Niue" />
                        <apex:selectOption itemValue="Pacific/Norfolk" />
                        <apex:selectOption itemValue="Pacific/Noumea" />
                        <apex:selectOption itemValue="Pacific/Pago_Pago" />
                        <apex:selectOption itemValue="Pacific/Palau" />
                        <apex:selectOption itemValue="Pacific/Pitcairn" />
                        <apex:selectOption itemValue="Pacific/Ponape" />
                        <apex:selectOption itemValue="Pacific/Port_Moresby" />
                        <apex:selectOption itemValue="Pacific/Rarotonga" />
                        <apex:selectOption itemValue="Pacific/Saipan" />
                        <apex:selectOption itemValue="Pacific/Tahiti" />
                        <apex:selectOption itemValue="Pacific/Tarawa" />
                        <apex:selectOption itemValue="Pacific/Tongatapu" />
                        <apex:selectOption itemValue="Pacific/Truk" />
                        <apex:selectOption itemValue="Pacific/Wake" />
                        <apex:selectOption itemValue="Pacific/Wallis" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="PUBLIC_CHECKED_PBSI"
                helpText="Controls the default behavior of the 'Public' checkbox on the 'New Comment' page.">
                    <apex:outputLabel value="Check the 'Public' checkbox by default"
                    for="PUBLIC_CHECKED_Checkbox" />
                    <apex:inputCheckbox value="{!PUBLIC_CHECKED}" selected="{!PUBLIC_CHECKED}" id="PUBLIC_CHECKED_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="INCLUDE_CLOSED_CASE_STATUS_PBSI"
                helpText="Check this box if you would like to allow users to choose closed case statuses while adding a new comment.">
                    <apex:outputLabel value="Include Closed Case Statuses"
                    for="INCLUDE_CLOSED_CASE_STATUS_Checkbox" />
                    <apex:inputCheckbox value="{!INCLUDE_CLOSED_CASE_STATUS}" selected="{!INCLUDE_CLOSED_CASE_STATUS}" id="INCLUDE_CLOSED_CASE_STATUS_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="COLLAPSE_CASE_SUMMARY_SECTION_PBSI"
                helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputLabel value="Collapse Case Summary Section"
                    for="COLLAPSE_CASE_SUMMARY_SECTION_Checkbox" />
                    <apex:inputCheckbox value="{!COLLAPSE_CASE_SUMMARY_SECTION}" selected="{!COLLAPSE_CASE_SUMMARY_SECTION}" id="COLLAPSE_CASE_SUMMARY_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="COLLAPSE_CUSTOM_FIELDS_SECTION_PBSI"
                    helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" rendered="false" />
                        <apex:outputLabel value="Collapse Case Fields Section" for="COLLAPSE_CUSTOM_FIELDS_SECTION_Checkbox" />
                    </apex:outputPanel>
                    <apex:inputCheckbox value="{!COLLAPSE_CUSTOM_FIELDS_SECTION}" selected="{!COLLAPSE_CUSTOM_FIELDS_SECTION}" id="COLLAPSE_CUSTOM_FIELDS_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="ConfigureFieldSet"
                helptext="Email to Case Premium uses Salesforce Field Sets to allow you to select which fields are available for display (and editing) on the New Comment page.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" rendered="false" />
                        <apex:outputLabel value="Select Case Fields on New Comment Page" />
                    </apex:outputPanel>
                    <a href="/p/setup/custent/FieldSetListUI/d?tableEnumOrId=Case&setupid=CaseFieldSets" target="_blank" >Click here and select Edit for New Comment Case Fields</a>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="COLLAPSE_COMMENTS_SECTION_PBSI"
                helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputLabel value="Collapse Previous Comments Section"
                    for="COLLAPSE_COMMENTS_SECTION_Checkbox" />
                    <apex:inputCheckbox value="{!COLLAPSE_COMMENTS_SECTION}" selected="{!COLLAPSE_COMMENTS_SECTION}" id="COLLAPSE_COMMENTS_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="ENABLE_CANNED_COMMENTS_PBSI"
                helpText="Allow your users to select Canned Comments when adding a new comment. Canned Comments can be managed by going to the Canned Comments tab.">
                    <apex:outputLabel value="Enable Canned Comments" for="ENABLE_CANNED_COMMENTS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_CANNED_COMMENTS}" selected="{!ENABLE_CANNED_COMMENTS}" id="ENABLE_CANNED_COMMENTS_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="SHORT_HISTORY_TEXT"
                helpText="The E2CP__HistoryText__c field contains a chronology of the last 25 public comments on a case that can be merged in an email template.  By excluding the most recent public comment, you can use a custom merge field containing the most recent public comment, followed by merge fields for the sender's signature, and finally followed by the history text, to allow for a more personalized email template. ">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" rendered="false"/>
                        <apex:outputLabel value="Exclude Most Recent Comment from History Text" for="SHORT_HISTORY_TEXT_Checkbox" />
                    </apex:outputPanel>
                    <apex:inputCheckbox value="{!SHORT_HISTORY_TEXT}" selected="{!SHORT_HISTORY_TEXT}" id="SHORT_HISTORY_TEXT_Checkbox" />
                </apex:pageBlockSectionItem>
                
                
                <apex:pageBlockSectionItem id="COMMENT_BOX_WIDTH"
                helpText="The width of the comment entry box in pixels. ">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" />
                        <apex:outputLabel value="Comment Entry Box Width" for="COMMENT_BOX_WIDTH_Text" />
                    </apex:outputPanel>
                    <apex:inputText value="{!COMMENT_BOX_WIDTH}" id="COMMENT_BOX_WIDTH_Text"  size="3"/>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="COMMENT_BOX_HEIGHT"
                helpText="The height of the comment entry box in pixels. ">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" />
                        <apex:outputLabel value="Comment Entry Box Height" for="COMMENT_BOX_HEIGHT_Text" />
                    </apex:outputPanel>
                    <apex:inputText value="{!COMMENT_BOX_HEIGHT}" id="COMMENT_BOX_HEIGHT_Text" size="3"/>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="ENABLE_PUBLIC_WARNING"
                helpText="A customized warning can be displayed whenever a public comment is being entered on the New Comment page.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" />
                        <apex:outputLabel value="Display Warning for Public Comments" for="ENABLE_PUBLIC_WARNING_Checkbox" />
                    </apex:outputPanel>
                    <apex:inputCheckbox value="{!ENABLE_PUBLIC_WARNING}" selected="{!ENABLE_PUBLIC_WARNING}" id="ENABLE_PUBLIC_WARNING_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="PUBLIC_WARNING_TEXT"
                helpText="The text displayed when the Public checkbox is enabled.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" />
                        <apex:outputLabel value="Public Warning Text" for="PUBLIC_WARNING_TEXT_text" />
                    </apex:outputPanel>
                    <apex:inputTextarea value="{!PUBLIC_WARNING_TEXT}"  id="PUBLIC_WARNING_TEXT_text" cols="120" rows="2" />
                </apex:pageBlockSectionItem>
                
            </apex:PageBlockSection>


            
            <!-- ///////////Email Notification Recipients//////////// -->           

            <apex:PageBlockSection collapsible="true" title="Email Notification Recipients" columns="1" id="emailNotificationPrefPBS">         

                <apex:pageBlockSectionItem id="LABEL_CONTACT_NAME_PBSI"
                helpText="If your organization refers to case contacts using other terminology, for example, customers, clients, etc, you can set that name here.">
                    <apex:outputLabel value="Label - Contact"
                    for="LABEL_CONTACT_NAME_Text"/>
                    <apex:inputText size="25" maxlength="32200" value="{!LABEL_CONTACT_NAME}" id="LABEL_CONTACT_NAME_Text" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="ERROR_INVALID_CONTACT_PBSI"
                helpText="Error text displayed when a Contact or Contact Role has a missing or invalid email address.">
                    <apex:outputLabel value="Error - Invalid Contact"
                    for="ERROR_INVALID_CONTACT_Text"/>
                    <apex:inputText size="70" maxlength="32200" value="{!ERROR_INVALID_CONTACT}" id="ERROR_INVALID_CONTACT_Text" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="LABEL_LEAD_PBSI" rendered="{!ENABLE_LEADS}"
                helpText="If your organization refers to leads using other terminology, you can set that name here.">
                    <apex:outputLabel value="Label - Lead"
                    for="LABEL_LEAD_Text"/>
                    <apex:inputText size="25" maxlength="32200" value="{!LABEL_LEAD}" id="LABEL_LEAD_Text"  />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="ENABLE_CONTACT_ROLES_PBSI"
                helpText="If your organization uses Salesforce.com's standard Contact Roles functionality, you can include them on new comment email notifications.">
                    <apex:outputLabel value="Enable Contact Roles"
                    for="ENABLE_CONTACT_ROLES_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_CONTACT_ROLES}" selected="{!ENABLE_CONTACT_ROLES}" id="ENABLE_CONTACT_ROLES_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="ENABLE_TEAM_MEMBERS_PBSI" rendered="{!SUPPORTS_CASETEAMS}"
                helpText="If your organization uses Salesforce.com's standard Case Team functionality, you can include case team members  on new comment email notifications.">
                    <apex:outputLabel value="Enable Case Teams"
                    for="ENABLE_TEAM_MEMBERS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_TEAM_MEMBERS}" selected="{!ENABLE_TEAM_MEMBERS}" id="ENABLE_TEAM_MEMBERS_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="LABEL_TEAM_MEMBERS_NAME_PBSI" rendered="{!SUPPORTS_CASETEAMS}"
                helpText="If your organization refers to team members using other terminology, for example, employees, staff, etc, you can set that name here.">
                    <apex:outputLabel value="Label - Team Members"
                    for="LABEL_TEAM_MEMBERS_NAME_Text"/>
                    <apex:inputText size="25" maxlength="32200" value="{!LABEL_TEAM_MEMBERS_NAME}" id="LABEL_TEAM_MEMBERS_NAME_Text"  />
                </apex:pageBlockSectionItem>
                
                
                <!--
                <apex:pageBlockSectionItem id="UNCHECKED_TEAM_MEMBER_ROLES_PBSI" rendered="{!SUPPORTS_CASETEAMS}"
                helpText="Select any team member roles that you would like *not* to be checked by default on the New Comment page.  For example, you may want to have management listed as team members on a case, but don't want them to receive every new comment email notification.  Hold Ctrl to select more than one role.">
                    <apex:outputLabel value="Unchecked Team Member Roles" for="UNCHECKED_TEAM_MEMBER_ROLES_TextArea"/>
                    <apex:selectList id="UNCHECKED_TEAM_MEMBER_ROLES_TextArea" required="false" value="{!UNCHECKED_TEAM_MEMBER_ROLES}" multiselect="true">
                        <apex:selectOptions value="{!UNCHECKED_TEAM_MEMBER_ROLES_OPTIONS}" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                -->
                
                <apex:pageBlockSectionItem id="UNCHECKED_TEAM_MEMBER_ROLES_PBSI" rendered="{!SUPPORTS_CASETEAMS}"
                helpText="You can control the default recipient type behavior for team members on a role by role basis.  To, CC and BCC refer to the respective fields available when sending an email.  For example, you could have a role called 'Customer (Executive)' defaulting to No Email and a role called 'Customer (CC)' defaulting to CC.  These defaults can be overridden on the New Comment page.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" rendered="false" />
                        <apex:outputLabel value="Team Member Roles" for="UNCHECKED_TEAM_MEMBER_ROLES_TextArea"/>
                    </apex:outputPanel>
                    <apex:outputPanel >
                        <apex:outputPanel rendered="{!lstTeamMemberRoles.size = 0}">
                            This organization does not contain any Case Team Roles. <a href="/0B7?kp=500&setupid=CaseTeamRoles" target="_new">Click here to define them.</a>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!lstTeamMemberRoles.size > 0}" >
                            <table border="1" style="border-spacing:0;" >
                            <tr>
                                <td style="font-weight:bold; padding:3px;" >Role Name</td>
                                <td style="font-weight:bold; padding:3px;" >Default Recipient Type</td>
                            </tr>
                            <apex:repeat value="{!lstTeamMemberRoles}" var="r">
                                <tr >
                                    <td style="vertical-align: middle; padding: 0px 2px 0px 2px;">
                                        <apex:outputText value="{!r.rolename}"/>
                                    </td>
                                    <td style="vertical-align: middle;">
                                        <apex:selectRadio value="{!r.sendtype}" >
                                            <apex:selectOptions value="{!sendtypes}"/>
                                        </apex:selectRadio>
                                    </td>
                                </tr>
                            </apex:repeat>
                            </table>
                        </apex:outputPanel>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="ENABLE_ADDITIONAL_EMAILS_PBSI"
                helpText="You can allow your reps to manually specify To addresses to be included on new comment email notifications.">
                    <apex:outputLabel value="Enable Additional To"
                    for="ENABLE_ADDITIONAL_EMAILS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_ADDITIONAL_EMAILS}" selected="{!ENABLE_ADDITIONAL_EMAILS}" id="ENABLE_ADDITIONAL_EMAILS_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="ENABLE_ADDITIONAL_CCS_PBSI"
                helpText="You can allow your reps to manually specify CC addresses to be included on new comment email notifications.">
                    <apex:outputLabel value="Enable Additional CC"
                    for="ENABLE_ADDITIONAL_CCS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_ADDITIONAL_CCS}" selected="{!ENABLE_ADDITIONAL_CCS}" id="ENABLE_ADDITIONAL_CCS_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="ENABLE_ADDITIONAL_BCCS_PBSI"
                helpText="You can allow your reps to manually specify BCC addresses to be included on new comment email notifications.">
                    <apex:outputLabel value="Enable Additional BCC"
                    for="ENABLE_ADDITIONAL_BCCS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_ADDITIONAL_BCCS}" selected="{!ENABLE_ADDITIONAL_BCCS}" id="ENABLE_ADDITIONAL_BCCS_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="COLLAPSE_EMAILS_SECTION_PBSI"
                helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputLabel value="Collapse Emails Section" for="COLLAPSE_EMAILS_SECTION_Checkbox" />
                    <apex:inputCheckbox value="{!COLLAPSE_EMAILS_SECTION}" selected="{!COLLAPSE_EMAILS_SECTION}" id="COLLAPSE_EMAILS_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="EMAIL_NOTIFICATION_PBSI"
                helpText="Controls whether recipients are automatically selected to receive an email notification when the Public checkbox is selected. Note that the Unchecked Team Member Roles are still respected.">
                    <apex:outputLabel value="Check 'Email Notification' Checkboxes" for="EMAIL_NOTIFICATION_Checkbox" />
                    <apex:inputCheckbox value="{!EMAIL_NOTIFICATION}" selected="{!EMAIL_NOTIFICATION}" id="EMAIL_NOTIFICATION_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="SHOW_RECIPIENTS_IN_COMMENT_PBSI"
                helpText="The recipients of an email notification can be documented at the top of each comment for easy reference.  Alternatively, you can expose the Emails related list and open the respective email to obtain this information.">
                    <apex:outputLabel value="Show email recipients at the top of the comment"
                    for="SHOW_RECIPIENTS_IN_COMMENT_Checkbox" />
                    <apex:inputCheckbox value="{!SHOW_RECIPIENTS_IN_COMMENT}" selected="{!SHOW_RECIPIENTS_IN_COMMENT}" id="SHOW_RECIPIENTS_IN_COMMENT_Checkbox" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="USE_SIGNATURE_PBSI"
                helpText="Controls whether a user's personal signature is added to the bottom of an outgoing email when adding a new comment. Note that the signature is added to the very bottom of the outbound email, not the bottom of the new comment.  Consider using email template merge fields instead.  The signature is configured under Setup > Personal Setup > Email > My Email Settings.">
                    <apex:outputLabel value="Add Signature to Emails"
                    for="USE_SIGNATURE_Checkbox" />
                    <apex:inputCheckbox value="{!USE_SIGNATURE}" selected="{!USE_SIGNATURE}" id="USE_SIGNATURE_Checkbox" />
                </apex:pageBlockSectionItem>

            </apex:PageBlockSection>



            <!-- ///////////Attachments//////////// -->

            <apex:PageBlockSection collapsible="true" title="Attachments" columns="1" id="attachmentsPrefPBS">

                <apex:pageBlockSectionItem id="ENABLE_ATTACHMENTS_PBSI"
                helpText="When checked, your reps can select attachments associated with the case to be included as attachments on outbound new comment email notifications.">
                    <apex:outputLabel value="Enable Attachments Selection"
                    for="ENABLE_ATTACHMENTS_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_ATTACHMENTS}" selected="{!ENABLE_ATTACHMENTS}" id="ENABLE_ATTACHMENTS_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="COLLAPSE_ATTACHMENTS_SECTION_PBSI"
                helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputLabel value="Collapse Attachments Section"
                    for="COLLAPSE_ATTACHMENTS_SECTION_Checkbox" />
                    <apex:inputCheckbox value="{!COLLAPSE_ATTACHMENTS_SECTION}" selected="{!COLLAPSE_ATTACHMENTS_SECTION}" id="COLLAPSE_ATTACHMENTS_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>    
          
                <apex:pageBlockSectionItem id="ENABLE_ATTACHMENT_UPLOAD_PBSI"
                helpText="If the browser supports it, a file drag & drop panel will be displayed on the New Comment page. A manual upload button is always available.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="Pilot" />
                    <apex:outputLabel value="Enable Drag and Drop Attachment Upload"
                    for="ENABLE_ATTACHMENT_UPLOAD_Checkbox" />
                    </apex:outputPanel>
                    <apex:inputCheckbox value="{!ENABLE_ATTACHMENT_UPLOAD}" selected="{!ENABLE_ATTACHMENT_UPLOAD}" id="ENABLE_ATTACHMENT_UPLOAD_Checkbox" />
                </apex:pageBlockSectionItem>               

            </apex:PageBlockSection>


            <!-- ///////////Email Template//////////// -->          

            <apex:PageBlockSection collapsible="true" title="Email Template" columns="1" id="emailTemplatePrefPBS">

                <apex:pageBlockSectionItem id="EMAIL_TEMPLATES_FOLDER_PBSI"
                helpText="Folder containing email templates that users can select.">
                    <apex:outputLabel value="Email Template Folder"
                    for="EMAIL_TEMPLATES_FOLDER_Text"/>
                    <apex:outputPanel >
                        <apex:selectList id="EMAIL_TEMPLATES_FOLDER_Text" required="false" value="{!EMAIL_TEMPLATES_FOLDER}" multiselect="false" size="1">
                            <apex:selectOptions value="{!EMAIL_TEMPLATES_FOLDER_OPTIONS}" />
                            <apex:actionSupport event="onchange" action="{!refreshTemplates}" 
                                rerender="emailTemplatePrefPBS" status="refStat" />
                        </apex:selectList>
                        <apex:actionStatus id="refStat" startText=" (loading templates...)"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="DEFAULT_TEMPLATE_PBSI"
                helpText="When adding a new comment, this template will used by default for emails unless you have specified status/template pairs below.">
                    <apex:outputLabel value="Default Email Template"
                    for="DEFAULT_TEMPLATE_Text"/>
                    <apex:selectList id="DEFAULT_TEMPLATE_Text" required="false" value="{!DEFAULT_TEMPLATE}" multiselect="false" size="1">
                        <apex:selectOptions value="{!DEFAULT_TEMPLATE_OPTIONS}" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="ENABLE_TEMPLATE_SELECT_PBSI"
                helpText="Allows your users to select Visualforce templates that are marked Available for Use in the email template folder specified below.">
                    <apex:outputLabel value="Enable Template Selection"
                    for="ENABLE_TEMPLATE_SELECT_Checkbox" />
                    <apex:inputCheckbox value="{!ENABLE_TEMPLATE_SELECT}" selected="{!ENABLE_TEMPLATE_SELECT}" id="ENABLE_TEMPLATE_SELECT_Checkbox" />
                </apex:pageBlockSectionItem>             

                <apex:pageBlockSectionItem id="COLLAPSE_TEMPLATES_SECTION_PBSI"
                helpText="Check this box to collapse this section by default when the New Comment page loads.">
                    <apex:outputLabel value="Collapse Template Section"
                    for="COLLAPSE_TEMPLATES_SECTION_Checkbox" />
                    <apex:inputCheckbox value="{!COLLAPSE_TEMPLATES_SECTION}" selected="{!COLLAPSE_TEMPLATES_SECTION}" id="COLLAPSE_TEMPLATES_SECTION_Checkbox" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="STATUS_BASED_TEMPLATES_PBSI"
                helpText="Email templates can be auto-selected based upon case Status, Origin or both.  Email templates are selected when the New Comment is loaded and when either the Status or Origin field is changed on the New Comment page.  The first rule to match is used, so be sure to order them carefully.  For example, if the you want to use Template A when the Status=Closed, but use Template B when the Status=Closed and Origin=Gold Support, but sure to order the more specific rule first.">
                    <apex:outputPanel >
                        <apex:outputLabel style="color: red; font-size:smaller;" value="New!" rendered="false" />
                        <apex:outputLabel value="Template Auto-Selection Rules" for="STATUS_BASED_TEMPLATES_Panel"/>
                    </apex:outputPanel>
                    <apex:outputPanel id="STATUS_BASED_TEMPLATES_Panel">
                        <apex:outputPanel id="STATUS_BASED_TEMPLATES_EditPanel">
                                <table>
                                    <tr>
                                        <td><apex:outputText value="Status" style="font-weight:bold;" /></td>
                                        <td><apex:outputText value="Origin" style="font-weight:bold;" /></td>
                                        <td><apex:outputText value="Template" style="font-weight:bold;" /></td>
                                        <td colspan="2"><apex:outputText value="Order" style="font-weight:bold;" /></td>
                                    </tr>
                                    <apex:repeat value="{!lstInnerSBT}" var="e2" id="rptSBT">
                                        <tr>
                                            <td><apex:selectList id="PAIRED_STATUS_Text" required="false" value="{!e2.prefKeyStat}" multiselect="false" size="1">
                                                    <apex:selectOptions value="{!PAIRED_STATUS_OPTIONS}" />
                                                </apex:selectList>
                                            </td>
                                            <td>
                                                <apex:selectList id="PAIRED_ORIGIN_Text" required="false" value="{!e2.prefKeyOrig}" multiselect="false" size="1">
                                                    <apex:selectOptions value="{!REPLY_TO_ORIGIN_OPTIONS}" />
                                                </apex:selectList>
                                            
                                            </td>
                                            <td><apex:selectList id="PAIRED_TEMPLATE_Text" required="false" value="{!e2.prefValue}" multiselect="false" size="1">
                                                    <apex:selectOptions value="{!PAIRED_TEMPLATE_OPTIONS}" />
                                                </apex:selectList>
                                            </td>
                                            <td>
                                                <apex:commandButton action="{!moveUp}" value=" Move Up " reRender="STATUS_BASED_TEMPLATES_EditPanel" rendered="{!e2.ord != 0}" >
                                                    <apex:param name="sbtInd" value="{!e2.Ord}" />
                                                </apex:commandbutton>
                                            </td>
                                            <td>   
                                                <apex:commandButton action="{!moveDown}" value="Move Down" reRender="STATUS_BASED_TEMPLATES_EditPanel" rendered="{!e2.ord != lstInnerSBT.size-1}">
                                                    <apex:param name="sbtInd" value="{!e2.Ord}" />
                                                </apex:commandbutton>
                                            </td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                                <apex:commandbutton value="Add Row" action="{!AddSBT}" rerender="STATUS_BASED_TEMPLATES_EditPanel">
                                    <apex:param name="param1" value="2" />
                                </apex:commandbutton>
                        </apex:outputPanel>
                        
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                
            </apex:PageBlockSection>

        </apex:pageBlock>
    </apex:form>
    <script>
    //overwrite help
    var hlinks = getElementsByClassName('links')[0];
    hlinks.innerHTML = '<a href="http://www.ic-2000.com/support.asp" target="_new">Knowledge Base</a> | <a href="mailto:e2cpremium@ic-2000.com">e2cpremium@ic-2000.com</a> | +1.609.570.7200 <img src="/s.gif" alt="Help" class="helpIcon" title="Help">';
    hlinks.innerHTML += '<br/><div style="font-size:smaller">Free implementation assistance is available via email or phone.</div>';    
    
    hlinks.style.fontSize = 'larger';
    hlinks.style.position = 'absolute';
    hlinks.style.float  = 'right';
    hlinks.style.right = '0%';
    
    //elements by CSS style
    function getElementsByClassName(className) {
        var hasClassName = new RegExp("(?:^|\\s)" + className + "(?:$|\\s)");
        var allElements = document.getElementsByTagName("*");
        var results = [];
    
        var element;
        for (var i = 0; (element = allElements[i]) != null; i++) {
            var elementClass = element.className;
            if (elementClass && elementClass.indexOf(className) != -1 && hasClassName.test(elementClass))
                results.push(element);
        }
    
        return results;
    }
    </script>
</apex:page>